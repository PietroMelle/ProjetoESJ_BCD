<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Categorias</title>
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <section class="container">
        <h2>üìÅ Cadastro de Categorias</h2>

        <!-- Se√ß√£o de formul√°rio para adicionar nova categoria -->
        <section class="form-section">
            <h3>Nova Categoria</h3>
            
            <!-- Formul√°rio que envia dados via POST para /categorias -->
            <form action="/categorias" method="POST">
                <!-- Input para nome da categoria -->
                <section class="form-row">
                    <!-- Input para nome (obrigat√≥rio) -->
                    <section>
                      <input type="text" name="nome" placeholder="Nome da Categoria *" required>
                    </section>
                </section>
                
                <!-- Textarea para descri√ß√£o da categoria -->
                <section class="form-row">
                    <!-- Textarea onde o usu√°rio pode digitar uma descri√ß√£o detalhada -->
                    <section>
                      <textarea name="descricao" placeholder="Descri√ß√£o"></textarea>
                    </section>
                </section>
                
                <!-- Bot√£o para enviar o formul√°rio -->
                <button type="submit">‚úÖ Adicionar Categoria</button>
            </form>
        </section>

        <!-- Se houver erro, exibe a mensagem -->
        <!-- Isto acontece quando tenta excluir categoria com produtos -->
        <% if (error) { %>
            <p class="error">‚ö†Ô∏è <%= error %></p>
        <% } %>

        <!-- Wrapper da tabela com scroll horizontal -->
        <section class="table-wrapper">
            <!-- Tabela que lista todas as categorias -->
            <table>
                <!-- Header da tabela -->
                <tr>
                    <th>ID</th>         <!-- ID da categoria -->
                    <th>Nome</th>       <!-- Nome da categoria -->
                    <th>Descri√ß√£o</th>  <!-- Descri√ß√£o da categoria -->
                    <th>A√ß√µes</th>      <!-- Bot√µes editar/excluir -->
                </tr>
                
                <!-- Loopa pelas categorias e cria uma linha para cada -->
                <% categorias.forEach(cat => { %>
                    <tr>
                        <!-- ID da categoria -->
                        <td><%= cat.idcategoria %></td>
                        
                        <!-- Nome da categoria -->
                        <td><%= cat.nome %></td>
                        
                        <!-- Descri√ß√£o (ou '-' se vazia) -->
                        <td><%= cat.descricao || '-' %></td>
                        
                        <!-- C√©lula com bot√µes de a√ß√£o -->
                        <td>
                            <section class="action-buttons">
                                <!-- Link para editar a categoria -->
                                <a href="/categorias/editar/<%= cat.idcategoria %>">
                                    <button type="button">‚úèÔ∏è Editar</button>
                                </a>
                                
                                <!-- Formul√°rio para excluir a categoria -->
                                <form action="/categorias/excluir/<%= cat.idcategoria %>" method="POST">
                                    <!-- Bot√£o com confirma√ß√£o antes de excluir -->
                                    <button type="submit" class="btn-danger" onclick="return confirm('Tem certeza que deseja excluir?')">üóëÔ∏è Excluir</button>
                                </form>
                            </section>
                        </td>
                    </tr>
                <% }) %>
            </table>
        </section>
        
        <!-- Espa√ßo vazio -->
        <br>
        
        <!-- Link para voltar ao menu principal -->
        <a href="/menu" class="voltar">‚Üê Voltar ao Menu</a>
    </section>
</body>
</html>