<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produtos</title>
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <section class="container">
        <!-- Link para voltar ao menu principal -->
        <a href="/menu" class="voltar">‚Üê Voltar ao Menu</a>

        <br />
        <br />

        <h2>üì¶ Cadastro de Produtos</h2>
        
        <!-- Se√ß√£o de formul√°rio para adicionar novo produto -->
        <section class="form-section">
            <h3>Novo Produto</h3>
            
            <!-- Formul√°rio que envia dados via POST para /produtos -->
            <form action="/produtos" method="POST">
                <!-- Primeira linha de inputs -->
                <section class="form-row">
                    <!-- Input para nome do produto (obrigat√≥rio) -->
                    <section><input type="text" name="nome" placeholder="Nome do Produto *" required></section>
                    
                    <!-- Input para c√≥digo interno (obrigat√≥rio e √∫nico) -->
                    <section><input type="text" name="codigo_interno" placeholder="C√≥digo Interno *" required></section>
                    
                    <!-- Select para escolher a categoria -->
                    <section>
                        <select name="idcategoria">
                            <option value="">Categoria</option>
                            <!-- Loopa pelas categorias do servidor e cria op√ß√µes -->
                            <% categorias.forEach(c => { %>
                                <option value="<%= c.idcategoria %>"><%= c.nome %></option>
                            <% }) %>
                        </select>
                    </section>
                    
                    <!-- Input para nome do fabricante -->
                    <section><input type="text" name="fabricante" placeholder="Fabricante"></section>
                </section>
                
                <!-- Segunda linha de inputs -->
                <section class="form-row">
                    <!-- Input para pre√ßo de venda (n√∫mero decimal) -->
                    <section><input type="number" name="preco_venda" placeholder="Pre√ßo de Venda" step="0.01" min="0"></section>
                    
                    <!-- Input para estoque m√≠nimo -->
                    <section><input type="number" name="estoque_minimo" placeholder="Estoque M√≠nimo" min="0"></section>
                    
                    <!-- Input para voltagem do produto -->
                    <section><input type="text" name="voltagem" placeholder="Voltagem"></section>
                    
                    <!-- Input para cor do produto -->
                    <section><input type="text" name="cor" placeholder="Cor"></section>
                </section>
                
                <!-- Terceira linha de inputs -->
                <section class="form-row">
                    <!-- Input para peso em kg (n√∫mero decimal) -->
                    <section><input type="number" name="peso" placeholder="Peso (kg)" step="0.01" min="0"></section>
                    
                    <!-- Input para material do produto -->
                    <section><input type="text" name="material" placeholder="Material"></section>
                    
                    <!-- Input para descri√ß√£o -->
                    <section><input type="text" name="descricao" placeholder="Descri√ß√£o"></section>
                </section>
                
                <!-- Bot√£o para enviar o formul√°rio -->
                <button type="submit">‚úÖ Adicionar Produto</button>
            </form>
        </section>

        <!-- Se houver erro, exibe a mensagem de erro -->
        <% if (error) { %>
            <p class="error">‚ö†Ô∏è <%= error %></p>
        <% } %>

        <!-- Wrapper da tabela com scroll horizontal -->
        <section class="table-wrapper">
            <!-- Tabela que lista todos os produtos -->
            <table>
                <!-- Header da tabela -->
                <tr>
                    <th>A√ß√µes</th>     <!-- Bot√µes editar/excluir -->
                    <th>ID</th>        <!-- ID do produto -->
                    <th>Nome</th>      <!-- Nome do produto -->
                    <th>C√≥digo</th>    <!-- C√≥digo interno -->
                    <th>Categoria</th> <!-- Categoria do produto -->
                    <th>Fabricante</th><!-- Fabricante -->
                    <th>Pre√ßo</th>     <!-- Pre√ßo de venda -->
                    <th>Estoque Atual</th> <!-- Saldo atual -->
                    <th>Estoque M√≠nimo</th><!-- M√≠nimo permitido -->
                    <th>Voltagem</th>  <!-- Voltagem -->
                    <th>Cor</th>       <!-- Cor -->
                    <th>Peso (kg)</th> <!-- Peso -->
                    <th>Material</th>  <!-- Material -->
                    <th>Descri√ß√£o</th> <!-- Descri√ß√£o -->
                </tr>
                
                <!-- Loopa pelos produtos e cria uma linha para cada -->
                <% produtos.forEach(prod => { %>
                    <tr>
                        <!-- C√©lula com bot√µes de a√ß√£o -->
                        <td>
                            <section class="action-buttons">
                                <!-- Link para editar o produto -->
                                <a href="/produtos/editar/<%= prod.idproduto %>">
                                    <button type="button">‚úèÔ∏è Editar</button>
                                </a>
                                
                                <!-- Formul√°rio para excluir o produto -->
                                <form action="/produtos/excluir/<%= prod.idproduto %>" method="POST">
                                    <!-- Bot√£o com confirma√ßao antes de excluir -->
                                    <button type="submit" class="btn-danger" onclick="return confirm('Tem certeza que deseja excluir?')">üóëÔ∏è Excluir</button>
                                </form>
                            </section>
                        </td>
                        
                        <!-- Dados do produto em cada coluna -->
                        <td><%= prod.idproduto %></td>
                        <td><%= prod.nome %></td>
                        <td><%= prod.codigo_interno %></td>
                        <td><%= prod.categoria_nome || '-' %></td> <!-- Ou '-' se vazio -->
                        <td><%= prod.fabricante || '-' %></td>
                        <td>R$ <%= parseFloat(prod.preco_venda).toFixed(2) %></td> <!-- Formata como moeda -->
                        <td><%= prod.estoque_atual || 0 %></td> <!-- Ou 0 se vazio -->
                        <td><%= prod.estoque_minimo %></td>
                        <td><%= prod.voltagem || '-' %></td>
                        <td><%= prod.cor || '-' %></td>
                        <td><%= prod.peso || '-' %></td>
                        <td><%= prod.material || '-' %></td>
                        <td><%= prod.descricao || '-' %></td>
                    </tr>
                <% }) %>
            </table>
        </section>
        
    </section>
</body>
</html>